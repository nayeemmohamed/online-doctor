<!-- rewrite this file by qiaoli wang -->
<!-- wangqiao@deakin.edu.au -->
<div class="dashboard-user row">
  <div class="display-flex-baseline mt-4 mb-4">
    <div class="avar-name">
      <span class="avar-img mr-10"><img src="https://cdn1.iconfinder.com/data/icons/web-55/32/web_3-1024.png" width="65"/></span>
      <div class="">
        <div class="username">
          <%= user.name %>
        </div>
        <div><%= user.email %></div>
      </div>
    </div>
    <a href="/users/logout" class="btn btn-light">Logout</a>
  </div>
</div>

<div class="container">
  <nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
      <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Home</a>
      <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Profile</a>
      <a class="nav-item nav-link" id="nav-appointment-tab" data-toggle="tab" href="#nav-appointment" role="tab" aria-controls="nav-appointment" aria-selected="false">Appointments</a>
    </div>
  </nav>
  <div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
       <div class="row mt-4 mb-4">
          <div class="card profile text-center col-md-2 border-0 shadow mr-10 mb-3">
            <div class="profile-list card-body">
              <p class="profile-item set-profile"><i class="fas fa-address-card"></i></p>
              <button  type="button" class="btn btn-light" onclick="goToProfileForm()" >Set up profile</button>
            </div>
          </div>
          <div class="card profile text-center col-md-2 border-0 shadow mr-10 mb-3">
            <div class="profile-list card-body">
              <p  class="profile-item appointment"><i class="fas fa-calendar-check"></i></p>
              <button type="button" class="btn btn-light" onclick="goToAppointmentTab()">Make a Appointment</button>
            </div>
          </div>
       </div>
       <div class="row">
          <h5 class="dashboard-common-title">My Appointments</h5>
          <div class="container bg-white mt-2">
            <div class="row">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Time</th>
                    <th scope="col">Doctor Name</th>
                    <th scope="col">Doctor Contact</th>
                    <th scope="col">Patient Name</th>
                    <th scope="col">Patient Email</th>
                    <th scope="col">Operation</th>
                  </tr>
                </thead>
                <tbody  id="appointments">
                </tbody>
              </table>
            </div>
          </div>
       </div>
    </div>
    <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
      <div class="profile-form-container" data-uid="<%= user._id %>">
        <div class="form-group row mb-3">
          <label for="Birthday" class="col-sm-2 col-form-label">Birthday</label>
          <div class="col-sm-3">
            <input type="date" class="form-control" id="Birthday" placeholder="Birthday" value="<%= user.birthday %>">
          </div>
        </div>
        <div class="form-group row mb-3">
          <label for="PhoneNumber" class="col-sm-2 col-form-label">Phone number</label>
          <div class="col-sm-10">
            <input type="text" class="form-control" id="PhoneNumber" placeholder="Phone number (eg. 410796077)" value="<%= user.phoneNumber %>">
          </div>
        </div>
        <div class="form-group row mb-3">
          <label for="Gender" class="col-sm-2 col-form-label">Gender</label>
          <div class="col-sm-10">
            <select class="form-control" id="Gender">
              <option>Please Select one</option>
              <option <%= user.gender == 'Male' ? 'selected' :'' %> >Male</option>
              <option <%= user.gender == 'Female' ? 'selected' :'' %>>Female</option>
              <option <%= user.gender == 'Others' ? 'selected' :'' %> >Others</option>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <div class="col-sm-12" style="text-align: right;">
            <button type="submit" class="btn btn-secondary mr-10">Cancel</button>
            <button type="submit" class="btn btn-primary" id="profileUpdate">Update</button>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-pane fade" id="nav-appointment" role="tabpanel" aria-labelledby="nav-appointment-tab">
      <div class="form-inline">
      <div class="row mt-4">
        <div class="col-auto">
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">Appointment From</div>
            </div>
            <select class="form-control" id="appointFrom">
              <option value="09:00-AM">09:00-AM</option>
              <option value="09:30-AM">09:30-AM</option>
              <option value="10:00-AM">10:00-AM</option>
              <option value="10:30-AM">10:30-AM</option>
              <option value="11:00-AM">11:00-AM</option>
              <option value="11:30-AM">11:30-AM</option>
              <option value="12:00-PM">12:00-PM</option>
              <option value="12:30-PM">12:30-PM</option>
              <option value="01:00-PM">01:00-PM</option>
              <option value="01:30-PM">01:30-PM</option>
              <option value="02:00-PM">02:00-PM</option>
              <option value="02:30-PM">02:30-PM</option>
              <option value="03:00-PM">03:00-PM</option>
              <option value="03:30-PM">03:30-PM</option>
              <option value="04:00-PM">04:00-PM</option>
              <option value="04:30-PM">04:30-PM</option>
              <option value="05:00-PM">05:00-PM</option>
              <option value="05:30-PM">05:30-PM</option>
              <option value="06:00-PM">06:00-PM</option>
              <option value="06:30-PM">06:30-PM</option>
              <option value="07:00-PM">07:00-PM</option>
              <option value="07:30-PM">07:30-PM</option>
              <option value="08:00-PM">08:00-PM</option>
              <option value="08:30-PM">08:30-PM</option>
              </select>
          </div>
        </div>
        <div class="col-auto">
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">To</div>
            </div>
            <select class="form-control" id="appointTo">
              <option value="09:30-AM">09:30-AM</option>
              <option value="10:00-AM">10:00-AM</option>
              <option value="10:30-AM">10:30-AM</option>
              <option value="11:00-AM">11:00-AM</option>
              <option value="11:30-AM">11:30-AM</option>
              <option value="12:00-PM">12:00-PM</option>
              <option value="12:30-PM">12:30-PM</option>
              <option value="01:00-PM">01:00-PM</option>
              <option value="01:30-PM">01:30-PM</option>
              <option value="02:00-PM">02:00-PM</option>
              <option value="02:30-PM">02:30-PM</option>
              <option value="03:00-PM">03:00-PM</option>
              <option value="03:30-PM">03:30-PM</option>
              <option value="04:00-PM">04:00-PM</option>
        
              <option value="04:30-PM">04:30-PM</option>
              <option value="05:00-PM">05:00-PM</option>
              <option value="05:30-PM">05:30-PM</option>
              <option value="06:00-PM">06:00-PM</option>
              <option value="06:30-PM">06:30-PM</option>
              <option value="07:00-PM">07:00-PM</option>
              <option value="07:30-PM">07:30-PM</option>
              <option value="08:00-PM">08:00-PM</option>
              <option value="08:30-PM">08:30-PM</option>
              <option value="09:00-PM">09:00-PM</option>
            </select>
          </div>
        </div>

        <div class="col-auto">
          <div class="input-group mb-2">
            <div class="input-group-prepend">
              <div class="input-group-text">Speciality</div>
            </div>
            <select class="form-control" id="speciality">
              <option value="all">All</option>
            </select>
          </div>
        </div>


        <div class="col-sm-2">
          <button class="btn btn-primary" onclick="searchDoctors()"
          >Search</button>
          <!-- sort button get sorted data from server -->
          <a class="btn btn-dark" onclick="searchDoctors(true)">
            <i class="bi bi-sort-numeric-up" role="img" aria-label="SortUp"></i>
          </a>
        </div>

         
      </div>
      <div style="color: white;font-size: xx-large;" id="loadingDiv">
      <div class="spinner-border text-light" role="status">
        <span class="sr-only">Loading...</span>
      </div> Loading...
      </div>

      <div class="container">
        <div class="row mt-5" id="doctorList">
          
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel2" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel2">Contact Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="emailNumber">

      </div>
      <div class="modal-footer">
        <!-- <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button> -->
        <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">New Appointment</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="container">
          <h5>Doctor: <span id="appointmentDoctor"></span></h5>
          <h6>Selected Time: <span id="appointmentTime" style="color: green;"></span></h6>
          <p><h5>Patient Information</h5></p>
          <div class="form-group row mb-3">
           <label for="patientName" class="col-sm-2 col-form-label">Name</label>
           <div class="col-sm-10">
             <input type="text" class="form-control" id="patientName" placeholder="full name" value="<%= user.name %>">
           </div>
         </div>
         <div class="form-group row mb-3">
           <label for="patientGender" class="col-sm-2 col-form-label">Gender</label>
           <div class="col-sm-10">
             <select class="form-control" id="patientGender">
               <option <%= user.gender == 'Male' ? 'selected' :'' %> >Male</option>
               <option <%= user.gender == 'Female' ? 'selected' :'' %>>Female</option>
               <option <%= user.gender == 'Others' ? 'selected' :'' %> >Others</option>
             </select>
           </div>
         </div>
          <div class="form-group row mb-3">
             <label for="patientBirthday" class="col-sm-2 col-form-label">Birthday</label>
             <div class="col-sm-10">
               <input type="date" class="form-control" id="patientBirthday" placeholder="Age" value="<%= user.birthday %>">
             </div>
           </div>
           <div class="form-group row mb-3">
             <label for="patientEmail" class="col-sm-2 col-form-label">Email</label>
             <div class="col-sm-10">
               <input type="text" class="form-control" id="patientEmail" placeholder="Email" value="<%= user.email %>">
             </div>
           </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="confirmBooking">Book Now</button>
      </div>
    </div>
  </div>
</div>
<%- include ("./partials/messages"); %>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
  <link href="/style.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="/js/patientClient.js"></script>